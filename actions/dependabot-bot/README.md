# dependabot-bot -- Generator for dependabot.yml for .NET

dependabot-bot generates [Dependabot](https://docs.github.com/code-security/dependabot/dependabot-version-updates) YAML files for GitHub repositories that contain .NET projects. Dependabot is a GitHub service for automatically updating dependencies listed in project files for various package managers, including NuGet.

Dependabot works out of the box if you have a solution (`.sln`) or project file (like `.csproj`) at the root of the repo. It also supports _packages.config_.

This tool is for repos that contain projects that are [not discoverable from any one location](https://github.com/dependabot/feedback/issues/632). [dotnet/samples](https://github.com/dotnet/samples) is a good example of this case, and has a [dependabot.yml](https://github.com/dotnet/samples/blob/main/.github/dependabot.yml) (generated by this tool) that describes all projects within the repo.

Dependabot also supports specifying ranges of package versions that should be ignored as candidates for updates. The dependabot-bot tool uses a [JSON file](packages-ignore.json) ([source](https://github.com/richlander/dependabot-data-processing)) that maps target frameworks to incompatible package versions, and generates dependabot manifests to match ([example](https://github.com/richlander/dependabot-dotnet-test-projects/blob/main/.github/dependabot.yml)).

## Install the tool

**Important security alert!**

> [!WARNING]
> This tool isn't distributed as a NuGet package or a .NET CLI tool. Instead, it's provided as a GitHub Action, designed to be executed within a GitHub Actions workflow. Be cautious of potential impersonators claiming to offer this tool, and ensure you only run code from trusted sources.

## GitHub Action workflow

The `dependabot-bot` is exposed as a composite GitHub Action. To consume this, you'll need a workflow file similar to the following:

```yml
# The name used in the GitHub UI for the workflow
name: 'update dependabot.yml'

# When to run this action:
# - Scheduled to run at 5 AM every Monday.
# - Manually runnable from the GitHub UI with a reason
on:
  schedule:
  - cron: '0 5 * * 1' # 5 AM every Monday.
  workflow_dispatch:
    inputs:
      reason:
        description: 'The reason for running the workflow'
        required: true
        default: 'Manual run'

# Run on the latest version of Ubuntu
jobs:
  dependabot-bot:
    runs-on: ubuntu-latest

    # Checkout the repo into the workspace within the VM
    steps:
    - uses: actions/checkout@v3

    # If triggered manually, print the reason why
    - name: 'Print manual run reason'
      if: ${{ github.event_name == 'workflow_dispatch' }}
      run: |
        echo "Reason: ${{ github.event.inputs.reason }}"

    # Run the .NET dependabot-bot tool
    - name: dependabot-bot
      id: dependabot-bot
      uses: dotnet/docs-tools/actions/dependabot-bot@main
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        root-directory: '/github/workspace'
        dependabot-yml-path: '.github/dependabot.yml'
```
